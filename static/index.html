<!DOCTYPE html>
<html lang="en">
	<head>
		<title>Teddy Bear Music Status</title>
        <link rel="stylesheet" type="text/css" href="static/Style.css" />
		<script type="text/javascript" src="static/jquery-1.8.3.min.js"></script>
		<script type="text/javascript">
            var SongList = [];            

            window.onload = function() {
                UpdateStatus();

                $.get('/song/list')
                .done(function(data) {
                    data.sort();
                    var list = $('#SongList');
                    $.each(data, function(index, val) {
                        AddSongToList(val);
                    });

                    // Store the list
                    SongList = data;

                    // Activate the filter box
                    $('#FilterBox').keyup(function() {
                        FilterSongList($('#FilterBox').val());
                    });
                });
			};

            UpdateStatus = function() {
                $.get('/song/current')
                .done(function(data) {
                    $('#CurrentlyPlaying').text(data);
                });

                setTimeout(UpdateStatus, 5000);
            };

            FilterSongList = function(includes) {
                $('#SongList').empty();
                $.each(SongList, function(index, val) {
                    if (val.indexOf(includes) >= 0) {
                        AddSongToList(val);
                    }
                });
            };

            AddSongToList = function(val) {
                $('#SongList').append('<li><form action="/song/next' + val + '" method="POST"><input type="submit" value="Queue Song">' + val + '</form></li>')
            };
		</script>
	</head>
	<body>
        <center>
            <h1>Currently Playing</h1>
            <h2 id="CurrentlyPlaying"></h2>
            <form action="song/next" method="POST">
                <input type="submit" value="Skip Song">
            </form>
            Filter Song List: <input type="text" value="" id="FilterBox">
        </center>
        <ul id="SongList"></ul>
	</body>
</html>
